new Vue({
  el: '#app',
  vuetify: new Vuetify(),
  data() {
    return {
      authorized: true,
      debug: true,
      channels: [],
      applicationConfiguration,
      surveyConfiguration,
      formSubmitting: false,
      survey,
      subscriber: {
        subscriberKey: subscriberKey,
        emailAddress: emailAddress,
        subscriberId: subscriberId
      }
    }
  },
  mounted() {
    this.debug && this.debugData();
  },
  methods: {
    debugData() {
      this.debug && console.log(this.$data)
    },
    async onSubmitPreferenceForm($event) {
      try {
        const postData = [];
        const event = $event;
        console.log($event)
        for(const e in event){
          postData.push({
            Name: e,
            Value: event[e]
          })
        }

        const submitRequest = await axios.post(`${this.apiBaseURL}submitPreferenceForm`, {
          postData
        })

        console.log(submitRequest)
        if(submitRequest.data.Status === 'OK'){
          Vue.$toast.success(`Thank you for updating your preferences!`)
          this.getExistingPreferences();
        }

      } catch (err) {
        console.log(err)
        Vue.$toast.success(`There was an error: [${err.message}]`)
      }
    }
  },
  computed: {
    apiBaseURL() {
      return `${this.applicationConfiguration.apiBaseURL}?survey=${this.survey}&action=`
    },
    branding() {
      return this.applicationConfiguration.branding.default
    }
  }
})